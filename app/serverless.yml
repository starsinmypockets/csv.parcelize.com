service: parcelize

# You can pin your service to only deploy with a specific Serverless version
# Check out our docs for more details
# frameworkVersion: "=X.X.X"

provider:
  name: aws
  runtime: nodejs8.10
  iamRoleStatements:
    - Effect: Allow
      Resource: "*"
      Action:
        - ses:SendEmail
        - ses:SendRawEmail
        - s3:*

functions:
  authorize:
    handler: src/authorize.handler
  
  listen: 
    handler: src/app.handler
    events:
      - http:
          path: /
          method: ANY
          authorizer: authorize
          cors: true
      - http:
          path: /{proxy+}
          method: ANY
          authorizer: authorize
          cors: true
    environment:
      ENV: aws
      PARCELIZE_MLAB_CONNECT: ${env:PARCELIZE_MLAB_CONNECT}
    iamRoleStatements:
      - Effect: Allow
        Resource: "*"
        Action:
          - ses:SendEmail
          - ses:SendRawEmail
package:
  include:
    - src/**
